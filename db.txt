create table predavac(
	id serial primary key,
	email varchar(50) not null unique,
	password varchar(20) not null,
	first_name varchar(20),
	last_name varchar(20)
);

create table predmeti(
	id serial primary key,
	ime varchar(30) not null unique
);

create table predavanja(
	id serial primary key,
	naziv_predavanja varchar(30) not null,
	redni_broj int not null
);

create table anketa(
	id serial primary key,
	naziv varchar(20) not null unique
);

create table pitanje(
	id serial primary key,
	tekst varchar(100) not null
);


alter table predmeti add column predavac_id int;
alter table predmeti add constraint fk_predavac_id foreign key (predavac_id) references predavac(id) on delete cascade;

alter table predavanja add column predmet_id int;
alter table predavanja add constraint fr_predmet_id foreign key (predmet_id) references predmeti(id) on delete cascade;

alter table predavac alter column password type varchar(100);


select * from predmeti;

select * from predavac;

drop function getSubjectForProfesorWithId(id_prof int)

create or replace function getSubjectForProfesorWithId(in id_prof int) returns table (id int,ime varchar)
as $$
begin
	return query select pr.id, pr.ime from predavac p left join predmeti pr on p.id=id_prof; 
end; $$
language plpgsql;

select * from getSubjectForProfesorWithId(1);

CREATE TABLE pitanja_za_profesora (
  id serial primary key,
  pitanje_tekst varchar(255),
  broj_odobrenja int,
  broj_odbijenica int,
  odgovoreno boolean default false,
  predavanje_id int,
  foreign key (predavanje_id) references predavanja(id)
);

alter table pitanja_za_profesora
add constraint unique_pitanje_tekst
unique (pitanje_tekst)